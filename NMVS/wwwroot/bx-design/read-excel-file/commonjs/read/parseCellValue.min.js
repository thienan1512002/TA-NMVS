/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@bx-design/read-excel-file@0.1.1/commonjs/read/parseCellValue.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=getCellValue;var _parseDate=_interopRequireDefault(require("./parseDate"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _createForOfIteratorHelperLoose(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}var BUILT_IN_DATE_NUMBER_FORMAT_IDS=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57];function getCellValue(e,r,t){var a=t.getInlineStringValue,n=t.getStyleId,o=t.styles,i=t.values,u=t.properties,l=t.options;switch(r||(r="n"),r){case"str":""===(e=e.trim())&&(e=void 0);break;case"inlineStr":if(void 0===(e=a()))throw new Error('Unsupported "inline string" cell value structure');""===(e=e.trim())&&(e=void 0);break;case"s":""===(e=(e=i[parseInt(e)]).trim())&&(e=void 0);break;case"b":e="1"===e;break;case"z":e=void 0;break;case"e":e=decodeError(e);break;case"d":if(void 0===e)break;e=new Date(e);break;case"n":if(void 0===e)break;e=parseFloat(e);var s=n();if(s){var c=o[s];if(!c)throw new Error("Cell style not found: ".concat(s));(BUILT_IN_DATE_NUMBER_FORMAT_IDS.indexOf(parseInt(c.numberFormat.id))>=0||l.dateFormat&&c.numberFormat.template===l.dateFormat||!1!==l.smartDateParser&&c.numberFormat.template&&isDateTemplate(c.numberFormat.template))&&(e=(0,_parseDate.default)(e,u))}break;default:throw new TypeError("Cell type not supported: ".concat(r))}return void 0===e&&(e=null),e}function decodeError(e){switch(e){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(e)}}function isDateTemplate(e){for(var r,t=_createForOfIteratorHelperLoose(e.split(/\W+/));!(r=t()).done;){var a=r.value;if(["MM","DD","YY","YYYY"].indexOf(a)<0)return!1}return!0}
//# sourceMappingURL=/sm/7671ffabc0140112abf7658ba474db4d28b43bff5f4c47ee2c3a8131a56e7e42.map