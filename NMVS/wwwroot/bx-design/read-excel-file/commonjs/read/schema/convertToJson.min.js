/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@bx-design/read-excel-file@0.1.1/commonjs/read/schema/convertToJson.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_default,exports.parseValue=parseValue,exports.getBlock=getBlock,exports.parseArray=parseArray;var _parseDate=_interopRequireDefault(require("../parseDate")),_Integer=_interopRequireWildcard(require("../../types/Integer")),_URL=_interopRequireWildcard(require("../../types/URL")),_Email=_interopRequireWildcard(require("../../types/Email"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,r){var t=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=t){var n,a,o=[],i=!0,u=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(o.push(n.value),!r||o.length!==r);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(u)throw a}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelperLoose(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var DEFAULT_OPTIONS={isColumnOriented:!1};function _default(e,r,t){var n=t=t?_objectSpread(_objectSpread({},DEFAULT_OPTIONS),t):DEFAULT_OPTIONS,a=n.isColumnOriented,o=n.rowMap;validateSchema(r),a&&(e=transpose(e));for(var i=e[0],u=[],l=[],f=1;f<e.length;f++){var p=read(r,e[f],f-1,i,l,t);p&&u.push(p)}if(o)for(var c,s=_createForOfIteratorHelperLoose(l);!(c=s()).done;){var y=c.value;y.row=o[y.row]+1}return{rows:u,errors:l}}function read(e,r,t,n,a,o){for(var i={},u=function(){var u=f[l],p=e[u],c="object"===_typeof(p.type)&&!Array.isArray(p.type),s=r[n.indexOf(u)];void 0===s&&(s=null);var y=void 0,d=void 0;if(c)y=read(p.type,r,t,n,a,o);else if(null===s)y=null;else if(Array.isArray(p.type)){var v=!1,b=parseArray(s).map((function(e){var r=parseValue(e,p,o);return r.error&&(y=e,d=r.error),null!==r.value&&(v=!0),r.value}));d||(y=v?b:null)}else{var _=parseValue(s,p,o);d=_.error,y=d?s:_.value}!d&&null===y&&p.required&&(d="required"),d?(d={error:d,row:t+1,column:u,value:y},p.type&&(d.type=p.type),a.push(d)):null!==y&&(i[p.prop]=y)},l=0,f=Object.keys(e);l<f.length;l++)u();return Object.keys(i).length>0?i:null}function parseValue(e,r,t){if(null===e)return{value:null};var n;if((n=r.parse?parseCustomValue(e,r.parse):r.type?parseValueOfType(e,Array.isArray(r.type)?r.type[0]:r.type,t):{value:e}).error)return n;if(null!==n.value){if(r.oneOf&&r.oneOf.indexOf(n.value)<0)return{error:"invalid"};if(r.validate)try{r.validate(n.value)}catch(e){return{error:e.message}}}return n}function parseCustomValue(e,r){try{return void 0===(e=r(e))?{value:null}:{value:e}}catch(e){return{error:e.message}}}function parseValueOfType(e,r,t){switch(r){case String:return"string"==typeof e?{value:e}:"number"==typeof e&&isFinite(e)?{value:String(e)}:{error:"invalid"};case Number:case _Integer.default:if("string"==typeof e){var n=e;if(e=parseFloat(e),String(e)!==n)return{error:"invalid"}}else if("number"!=typeof e)return{error:"invalid"};return isFinite(e)&&(r!==_Integer.default||(0,_Integer.isInteger)(e))?{value:e}:{error:"invalid"};case _URL.default:return"string"==typeof e&&(0,_URL.isURL)(e)?{value:e}:{error:"invalid"};case _Email.default:return"string"==typeof e&&(0,_Email.isEmail)(e)?{value:e}:{error:"invalid"};case Date:if(e instanceof Date)return{value:e};if("number"==typeof e){if(!isFinite(e))return{error:"invalid"};e=parseInt(e);var a=(0,_parseDate.default)(e,t.properties);return a?{value:a}:{error:"invalid"}}return{error:"invalid"};case Boolean:return"boolean"==typeof e?{value:e}:{error:"invalid"};default:if("function"==typeof r)return parseCustomValue(e,r);throw new Error("Unknown schema type: ".concat(r&&r.name||r))}}function getBlock(e,r,t){for(var n=0,a="";t+n<e.length;){var o=e[t+n];if(o===r)return[a,n];if('"'===o){var i=getBlock(e,'"',t+n+1);a+=i[0],n+='"'.length+i[1]+'"'.length}else a+=o,n++}return[a,n]}function parseArray(e){for(var r=[],t=0;t<e.length;){var n=_slicedToArray(getBlock(e,",",t),2),a=n[0];t+=n[1]+",".length,r.push(a.trim())}return r}var transpose=function(e){return e[0].map((function(r,t){return e.map((function(e){return e[t]}))}))};function validateSchema(e){for(var r=0,t=Object.keys(e);r<t.length;r++){var n=t[r];if(!e[n].prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}
//# sourceMappingURL=/sm/5c705ee6d1a59443e90a77c43423bd3cd41ba6531db62d05128cf4b2880f79df.map