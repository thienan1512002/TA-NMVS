/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@bx-design/read-excel-file@0.1.1/modules/read/schema/convertToJson.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=r&&("undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"]);if(null!=t){var n,o,a=[],i=!0,l=!1;try{for(t=t.call(r);!(i=(n=t.next()).done)&&(a.push(n.value),!e||a.length!==e);i=!0);}catch(r){l=!0,o=r}finally{try{i||null==t.return||t.return()}finally{if(l)throw o}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _createForOfIteratorHelperLoose(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach((function(e){_defineProperty(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function _defineProperty(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}import parseDate from"../parseDate";import Integer,{isInteger}from"../../types/Integer";import URL,{isURL}from"../../types/URL";import Email,{isEmail}from"../../types/Email";var DEFAULT_OPTIONS={isColumnOriented:!1};export default function(r,e,t){var n=t=t?_objectSpread(_objectSpread({},DEFAULT_OPTIONS),t):DEFAULT_OPTIONS,o=n.isColumnOriented,a=n.rowMap;validateSchema(e),o&&(r=transpose(r));for(var i=r[0],l=[],u=[],f=1;f<r.length;f++){var p=read(e,r[f],f-1,i,u,t);p&&l.push(p)}if(a)for(var s,y=_createForOfIteratorHelperLoose(u);!(s=y()).done;){var c=s.value;c.row=a[c.row]+1}return{rows:l,errors:u}}function read(r,e,t,n,o,a){for(var i={},l=function(){var l=f[u],p=r[l],s="object"===_typeof(p.type)&&!Array.isArray(p.type),y=e[n.indexOf(l)];void 0===y&&(y=null);var c=void 0,v=void 0;if(s)c=read(p.type,e,t,n,o,a);else if(null===y)c=null;else if(Array.isArray(p.type)){var m=!1,d=parseArray(y).map((function(r){var e=parseValue(r,p,a);return e.error&&(c=r,v=e.error),null!==e.value&&(m=!0),e.value}));v||(c=m?d:null)}else{var b=parseValue(y,p,a);v=b.error,c=v?y:b.value}!v&&null===c&&p.required&&(v="required"),v?(v={error:v,row:t+1,column:l,value:c},p.type&&(v.type=p.type),o.push(v)):null!==c&&(i[p.prop]=c)},u=0,f=Object.keys(r);u<f.length;u++)l();return Object.keys(i).length>0?i:null}export function parseValue(r,e,t){if(null===r)return{value:null};var n;if((n=e.parse?parseCustomValue(r,e.parse):e.type?parseValueOfType(r,Array.isArray(e.type)?e.type[0]:e.type,t):{value:r}).error)return n;if(null!==n.value){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid"};if(e.validate)try{e.validate(n.value)}catch(r){return{error:r.message}}}return n}function parseCustomValue(r,e){try{return void 0===(r=e(r))?{value:null}:{value:r}}catch(r){return{error:r.message}}}function parseValueOfType(r,e,t){switch(e){case String:return"string"==typeof r?{value:r}:"number"==typeof r&&isFinite(r)?{value:String(r)}:{error:"invalid"};case Number:case Integer:if("string"==typeof r){var n=r;if(r=parseFloat(r),String(r)!==n)return{error:"invalid"}}else if("number"!=typeof r)return{error:"invalid"};return isFinite(r)&&(e!==Integer||isInteger(r))?{value:r}:{error:"invalid"};case URL:return"string"==typeof r&&isURL(r)?{value:r}:{error:"invalid"};case Email:return"string"==typeof r&&isEmail(r)?{value:r}:{error:"invalid"};case Date:if(r instanceof Date)return{value:r};if("number"==typeof r){if(!isFinite(r))return{error:"invalid"};r=parseInt(r);var o=parseDate(r,t.properties);return o?{value:o}:{error:"invalid"}}return{error:"invalid"};case Boolean:return"boolean"==typeof r?{value:r}:{error:"invalid"};default:if("function"==typeof e)return parseCustomValue(r,e);throw new Error("Unknown schema type: ".concat(e&&e.name||e))}}export function getBlock(r,e,t){for(var n=0,o="";t+n<r.length;){var a=r[t+n];if(a===e)return[o,n];if('"'===a){var i=getBlock(r,'"',t+n+1);o+=i[0],n+='"'.length+i[1]+'"'.length}else o+=a,n++}return[o,n]}export function parseArray(r){for(var e=[],t=0;t<r.length;){var n=_slicedToArray(getBlock(r,",",t),2),o=n[0];t+=n[1]+",".length,e.push(o.trim())}return e}var transpose=function(r){return r[0].map((function(e,t){return r.map((function(r){return r[t]}))}))};function validateSchema(r){for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e];if(!r[n].prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}
//# sourceMappingURL=/sm/3d291046eb97229c0fe96bca4d3c212c244bffb0b743f1e828a190df115bf8dd.map