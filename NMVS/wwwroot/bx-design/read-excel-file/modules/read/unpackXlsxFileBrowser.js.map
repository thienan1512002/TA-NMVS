{"version":3,"sources":["../../source/read/unpackXlsxFileBrowser.js"],"names":["JSZip","unpackXlsxFile","file","files","loadAsync","then","zip","forEach","relativePath","zipEntry","dir","push","name","entries","Promise","all","map","async","content"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,cAAT,CAAwBC,IAAxB,EAA8B;AAC5C,MAAMC,KAAK,GAAG,EAAd;AAEA,SAAOH,KAAK,CAACI,SAAN,CAAgBF,IAAhB,EAAsBG,IAAtB,CAA2B,UAACC,GAAD,EAAS;AAC1C,QAAMH,KAAK,GAAG,EAAd;AACAG,IAAAA,GAAG,CAACC,OAAJ,CAAY,UAACC,YAAD,EAAeC,QAAf,EAA4B;AACvC,UAAI,CAACA,QAAQ,CAACC,GAAd,EAAmB;AAClBP,QAAAA,KAAK,CAACQ,IAAN,CAAWF,QAAQ,CAACG,IAApB;AACA;AACD,KAJD;AAMA,QAAMC,OAAO,GAAG,EAAhB;AACA,WAAOC,OAAO,CAACC,GAAR,CAAYZ,KAAK,CAACa,GAAN,CAAU,UAACd,IAAD,EAAU;AACtC,aAAOI,GAAG,CAACJ,IAAJ,CAASA,IAAT,EAAee,KAAf,CAAqB,QAArB,EAA+BZ,IAA/B,CAAoC,UAAAa,OAAO;AAAA,eAAIL,OAAO,CAACX,IAAD,CAAP,GAAgBgB,OAApB;AAAA,OAA3C,CAAP;AACA,KAFkB,CAAZ,EAGNb,IAHM,CAGD;AAAA,aAAMQ,OAAN;AAAA,KAHC,CAAP;AAIA,GAbM,CAAP;AAcA","sourcesContent":["import JSZip from 'jszip'\n\n/**\n * Reads XLSX file in a browser.\n * @param  {file} file - A file being uploaded in the browser.\n * @return {Promise} Resolves to an object holding XLSX file entries.\n */\nexport default function unpackXlsxFile(file) {\n\tconst files = {}\n\n\treturn JSZip.loadAsync(file).then((zip) => {\n\t\tconst files = []\n\t\tzip.forEach((relativePath, zipEntry) => {\n\t\t\tif (!zipEntry.dir) {\n\t\t\t\tfiles.push(zipEntry.name)\n\t\t\t}\n\t\t})\n\n\t\tconst entries = {}\n\t\treturn Promise.all(files.map((file) => {\n\t\t\treturn zip.file(file).async('string').then(content => entries[file] = content)\n\t\t}))\n\t\t.then(() => entries)\n\t})\n}"],"file":"unpackXlsxFileBrowser.js"}